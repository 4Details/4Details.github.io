---
title: FATE 1.2 实践01-虚拟机安装
date: 2020-08-27 10:10:29
tags: [FATE,FL]
category: [联邦学习]
---

# 创建虚拟机

## 新建虚拟机

使用VMWare WorkStation创建虚拟机（单机版只需要一台机器，集群版可以使用多台机器，下面示例中创建了3台虚拟机，配置均为 300G，16GB，4核处理器，系统镜像为 CentOS-7-x86_64-DVD-1810版本）

![新建向导1-创建包含空白硬盘的虚拟机](https://cdn.nlark.com/yuque/0/2020/png/343708/1578211619356-f76a066f-77d1-4e59-bac3-c373a9822dca.png)

![新建向导2-选择客户机操作系统](https://cdn.nlark.com/yuque/0/2020/png/343708/1578211631941-df372176-acae-452f-aba5-e354012fe5f3.png)

![新建向导3-命名虚拟机](https://cdn.nlark.com/yuque/0/2020/png/343708/1578211648272-b1667e39-59da-47c9-a326-d6dee2a57c01.png)

![新建向导4-指定磁盘容量](https://cdn.nlark.com/yuque/0/2020/png/343708/1578211986949-3b397809-17f7-4da8-adbb-5a9bf005419d.png)                         

![新建向导5-配置硬件信息](https://cdn.nlark.com/yuque/0/2020/png/343708/1578212074493-4a7b30de-9d8b-4179-83cf-65770884ea44.png)

![新建向导5-配置硬件信息](https://cdn.nlark.com/yuque/0/2020/png/343708/1578212497000-3b362b69-9acc-457f-8827-ebf3551f3858.png)

![虚拟机详细配置信息](https://cdn.nlark.com/yuque/0/2020/png/343708/1578212160231-787ca313-3b1c-408e-a053-e2ef15489642.png)                                       


## 配置操作系统

**启动虚拟机，加载并配置操作系统**



![选择默认语言](https://cdn.nlark.com/yuque/0/2020/png/343708/1578212891912-86368f3c-b915-4e88-8429-94eadfdb17f8.png)       ![image.png](https://cdn.nlark.com/yuque/0/2020/png/343708/1578213042405-3d3882a5-eba1-4c84-b1e4-ccbab97de9d7.png)


此处选择默认语言为【简体中文】，可以直接在编辑框输入快速查找。下一步则需要配置系统的软件、磁盘分区、网络等信息。


![详细配置](https://cdn.nlark.com/yuque/0/2020/png/343708/1578213182245-ffd02e18-c25e-4678-9f01-2e739060c606.png)


这里需要注意的是详细配置图中标注的1，2，3。本例中详细的配置如下：

![软件选择](https://cdn.nlark.com/yuque/0/2020/png/343708/1578213258382-d9854dc5-5778-4f2c-967e-8480f72425bb.png)



本例中选择的是GNOME桌面版的软件，已选环境附加选项可根据实际需要选择，选择桌面版的可视化环境有利于后续工作的进行。下一步选择安装目标位置中提前配置分区信息尤为重要！！！



![安装目标位置1-重新配置分区](https://cdn.nlark.com/yuque/0/2020/png/343708/1578213312407-738ef352-50ea-40f5-8c5e-e7b8979be917.png)


![安装目标位置2-选择自动创建分区](https://cdn.nlark.com/yuque/0/2020/png/343708/1578213342097-9320d6a9-2d4f-4b79-ae7f-65ee9738202c.png)


![安装目标位置3-重新配置分区磁盘](https://cdn.nlark.com/yuque/0/2020/png/343708/1578213415357-a2e519d4-f0ef-4c11-87fd-c2c56b5fa507.png)


官方文档中建议全部磁盘挂载到新建的用户app下，但是本例中将大部分磁盘挂载到root下，经实践是有效的，在如上配置之后点击【完成】即可完成磁盘及分区的配置。

下一步需要提前完成系统网络信息的配置，如主机名、ip、子网掩码、DNS、路由信息等。


![配置主机名](https://cdn.nlark.com/yuque/0/2020/png/343708/1578213943847-be3ce5b6-ed0f-4881-b5b9-70a653ffe581.png)


点击【配置】可进入ip、DNS等信息的配置。

![网络信息详细配置](https://cdn.nlark.com/yuque/0/2020/png/343708/1578214029364-e40dc499-9843-4930-8cc8-bbe7a45cb666.png)


在上图的配置中需要注意的是，选择手动配置IPv4的信息，地址、子网掩码和网关需要配置正确，本例中DNS服务器默认为网关信息。网络信息配置完成之后可以【开启】以太网的连接，详细的信息可以参考下图

![网络配置详细信息](https://cdn.nlark.com/yuque/0/2020/png/343708/1578214278690-9d37e778-1145-42b9-916d-e61d53b056c5.png)



1，2，3的所有信息完成配置之后点击【开始安装】则进入安装界面，此时可以配置系统root用户的密码以及新建用户。本例中遵循官方文档创建用户 app，在“高级用户配置”中，编辑app分属apps组，用户id为6000。



![安装进度页面](https://cdn.nlark.com/yuque/0/2020/png/343708/1578214428608-d9cd0512-bddb-4fc7-b022-67dfd3849d0f.png)


![高级用户配置](https://cdn.nlark.com/yuque/0/2020/png/343708/1578214478054-80630f51-9a98-42ed-a785-42b58a0d1312.png)


等待安装完成，【重启】即可进入桌面版的centos7 操作系统。



![等待重启](https://cdn.nlark.com/yuque/0/2020/png/343708/1578215717450-609c6d2b-2ceb-449c-86fd-0ef8daecbce6.png)



初始设置需要接受许可证协议，【完成配置】即可登录输入密码，进入系统。


![许可证](https://cdn.nlark.com/yuque/0/2020/png/343708/1578215847178-545b18e3-a15b-4a0d-9475-ee1bbb3631f2.png)



**提示：**在实际操作中无需一步步按照上述步骤创建三台或多台虚拟机，在创建完成一台虚拟机之后可以通过“克隆”操作得到已安装完成的虚拟机镜像，这样可以在一定程度上节约创建虚拟机的时间，需要注意的是，在克隆完成启动之前需要重新生成机器的mac地址，否则会造成mac冲突。因为原始虚拟机使用的是静态地址，所以在开启之后需要重新对副本虚拟机分配静态IP。

克隆方法主要是： 点击 **虚拟机-管理-克隆**  使用克隆虚拟机向导

![克隆虚拟机01](https://cdn.nlark.com/yuque/0/2020/png/343708/1578289326701-c9d9cbf8-c722-417d-9fc2-2778a37041c1.png)

![克隆虚拟机02](https://cdn.nlark.com/yuque/0/2020/png/343708/1578289363276-dbcda949-dd42-465c-a981-1dfe75e101c6.png)

![克隆虚拟机03](https://cdn.nlark.com/yuque/0/2020/png/343708/1578289390103-91ec1bac-0ad9-412a-94a2-6b5343a850f5.png)



**重命名和选择虚拟机所在路径之后点击【完成】即可。**

![重命名01](https://cdn.nlark.com/yuque/0/2020/png/343708/1578289456259-1bf9f72d-24df-4056-8b78-91206ac8723f.png)

![重命名02](https://cdn.nlark.com/yuque/0/2020/png/343708/1578289469898-3cf24c9f-9555-4a20-8bcd-d0e4de56eefd.png)

![正在克隆](https://cdn.nlark.com/yuque/0/2020/png/343708/1578287585987-8c999e3a-1337-4548-8d74-3c08fe796f02.png)



打开虚拟机之后可以使用  ifconfig查看网络配置信息

![查看配置](https://cdn.nlark.com/yuque/0/2020/png/343708/1578288131550-c9753bd9-6886-4dd4-9ce6-bc87971b482b.png)



需要更改的信息有 主机名、ip

![修改信息01](https://cdn.nlark.com/yuque/0/2020/png/343708/1578288307841-e6299fea-87c6-41fe-822f-6649e02f4d8e.png)



配置IP信息主要路径在 /etc/sysconfig/network-script，修改 sysconf-ens33 （ens33指的是网卡名称）

文件中可以修改的有是否静态ip，PROTO一项改为 static  配置ip地址，子网掩码，网关，dns

![修改信息02](https://cdn.nlark.com/yuque/0/2020/png/343708/1578288596711-36122905-dd83-4146-9119-abbe8de4ae92.png)



进入编辑页面

![修改信息03](https://cdn.nlark.com/yuque/0/2020/png/343708/1578288653339-0a91cfbd-67ba-482a-a533-dac9fe4a1c67.png)



半角状态输入'i'可修改内容，修改完成如下，Esc退出编辑，":wq"可以保存修改并退出vim编辑页面

![修改信息04](https://cdn.nlark.com/yuque/0/2020/png/343708/1578288819423-b94e630c-3bc7-4c08-9f67-cde7aba7af8e.png)



重启之后使用ifconfig查看，ip已经改变。

克隆得到另外两台虚拟机，按上述步骤修改IP信息之后即完成了本例中的创建虚拟机步骤。

------