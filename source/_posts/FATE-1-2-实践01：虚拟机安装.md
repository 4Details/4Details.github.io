---
title: FATE 1.2 实践01-虚拟机安装
date: 2020-08-27 10:10:29
tags: [FATE,FL]
category: [联邦学习]
---

# 创建虚拟机

## 新建虚拟机

使用VMWare WorkStation创建虚拟机（单机版只需要一台机器，集群版可以使用多台机器，下面示例中创建了3台虚拟机，配置均为 300G，16GB，4核处理器，系统镜像为 CentOS-7-x86_64-DVD-1810版本）

![新建向导1-创建包含空白硬盘的虚拟机](https://i2.tiimg.com/726074/89154bfc28d26208.png)

![新建向导2-选择客户机操作系统](https://i2.tiimg.com/726074/c4f11c041dc337fa.png)

![新建向导3-命名虚拟机](https://i2.tiimg.com/726074/1eaf6ac021042136.png)

![新建向导4-指定磁盘容量](https://i2.tiimg.com/726074/18eb58f7c246e1bd.png)                         

![新建向导5-配置硬件信息](https://i2.tiimg.com/726074/c61093a659d32204.png)

![新建向导5-配置硬件信息](https://i2.tiimg.com/726074/df56b15fb12f2fc7.png)

![虚拟机详细配置信息](https://i2.tiimg.com/726074/a5708abe2935f37f.png)                                       


## 配置操作系统

**启动虚拟机，加载并配置操作系统**



![选择默认语言](https://i2.tiimg.com/726074/65977403c14d0be4.png)     

  ![image.png](https://i2.tiimg.com/726074/c1b032023a455553.png)


此处选择默认语言为【简体中文】，可以直接在编辑框输入快速查找。下一步则需要配置系统的软件、磁盘分区、网络等信息。


![详细配置](https://i2.tiimg.com/726074/07cb7dde684ceed8.png)


这里需要注意的是详细配置图中标注的1，2，3。本例中详细的配置如下：

![软件选择](https://i2.tiimg.com/726074/bb8187d72aac1f05.png)



本例中选择的是GNOME桌面版的软件，已选环境附加选项可根据实际需要选择，选择桌面版的可视化环境有利于后续工作的进行。下一步选择安装目标位置中提前配置分区信息尤为重要！！！



![安装目标位置1-重新配置分区](https://i2.tiimg.com/726074/6d2573e8d831fbfe.png)


![安装目标位置2-选择自动创建分区](https://i2.tiimg.com/726074/6660030a861e7450.png)


![安装目标位置3-重新配置分区磁盘](https://i2.tiimg.com/726074/775d2f261664aa51.png)


官方文档中建议全部磁盘挂载到新建的用户app下，但是本例中将大部分磁盘挂载到root下，经实践是有效的，在如上配置之后点击【完成】即可完成磁盘及分区的配置。

下一步需要提前完成系统网络信息的配置，如主机名、ip、子网掩码、DNS、路由信息等。


![配置主机名](https://i2.tiimg.com/726074/0bbcf0a30e5a05c1.png)


点击【配置】可进入ip、DNS等信息的配置。

![网络信息详细配置](https://i2.tiimg.com/726074/34d23c8ae8c7d96f.png)


在上图的配置中需要注意的是，选择手动配置IPv4的信息，地址、子网掩码和网关需要配置正确，本例中DNS服务器默认为网关信息。网络信息配置完成之后可以【开启】以太网的连接，详细的信息可以参考下图

![网络配置详细信息](https://i2.tiimg.com/726074/0a5251eeb05aaf7d.png)



1，2，3的所有信息完成配置之后点击【开始安装】则进入安装界面，此时可以配置系统root用户的密码以及新建用户。本例中遵循官方文档创建用户 app，在“高级用户配置”中，编辑app分属apps组，用户id为6000。



![安装进度页面](https://i2.tiimg.com/726074/5b9f20707763fb54.png)


![高级用户配置](https://i2.tiimg.com/726074/211dae0da29db0ae.png)


等待安装完成，【重启】即可进入桌面版的centos7 操作系统。



![等待重启](https://i2.tiimg.com/726074/c22f8cb802262f87.png)



初始设置需要接受许可证协议，【完成配置】即可登录输入密码，进入系统。


![许可证](https://i2.tiimg.com/726074/a634908789cbb0a6.png)



**提示：**在实际操作中无需一步步按照上述步骤创建三台或多台虚拟机，在创建完成一台虚拟机之后可以通过“克隆”操作得到已安装完成的虚拟机镜像，这样可以在一定程度上节约创建虚拟机的时间，需要注意的是，在克隆完成启动之前需要重新生成机器的mac地址，否则会造成mac冲突。因为原始虚拟机使用的是静态地址，所以在开启之后需要重新对副本虚拟机分配静态IP。

克隆方法主要是： 点击 **虚拟机-管理-克隆**  使用克隆虚拟机向导

![克隆虚拟机01](https://i2.tiimg.com/726074/cc8c06ec9306c7ee.png)

![克隆虚拟机02](https://i2.tiimg.com/726074/f4890c2edc6d3bb3.png)

![克隆虚拟机03](https://i2.tiimg.com/726074/194b776452661499.png)



**重命名和选择虚拟机所在路径之后点击【完成】即可。**

![重命名01](https://i2.tiimg.com/726074/7231414d603260c5.png)

![重命名02](https://i2.tiimg.com/726074/589d26d2952860c4.png)

![克隆完成后的配置](https://i2.tiimg.com/726074/bd2662f83ef7ce1c.png)



打开虚拟机之后可以使用  ifconfig查看网络配置信息

![查看配置](https://i2.tiimg.com/726074/dad1a31fd9322fe7.png)



需要更改的信息有 主机名、ip

![修改信息01](https://i2.tiimg.com/726074/50130340c6d9654e.png)



配置IP信息主要路径在 /etc/sysconfig/network-script，修改 sysconf-ens33 （ens33指的是网卡名称）

文件中可以修改的有是否静态ip，PROTO一项改为 static  配置ip地址，子网掩码，网关，dns

![修改信息02](https://i2.tiimg.com/726074/666c8e958b48f118.png)



进入编辑页面

![修改信息03](https://i2.tiimg.com/726074/301894f1f186c05c.png)



半角状态输入'i'可修改内容，修改完成如下，Esc退出编辑，":wq"可以保存修改并退出vim编辑页面

![修改信息04](https://i2.tiimg.com/726074/769a038f27cc4adb.png)



重启之后使用ifconfig查看，ip已经改变。

克隆得到另外两台虚拟机，按上述步骤修改IP信息之后即完成了本例中的创建虚拟机步骤。

------